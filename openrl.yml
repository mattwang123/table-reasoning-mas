name: rlhf
channels:
  - nvidia
  - pytorch
  - conda-forge
  - defaults
dependencies:
  - python=3.10.18
  - cuda-toolkit=11.8
  - pip
  - pip:
      # Use PyTorch 2.6.0 to match vLLM requirement
      - torch==2.6.0
      - torchvision==0.21.0
      - torchaudio==2.6.0
      
      # ML packages
      - transformers==4.51.3
      - datasets==4.0.0
      - peft==0.17.0
      - accelerate==1.10.0
      
      # Essential utilities
      - numpy==1.26.4
      - pandas==2.3.1
      - tqdm==4.67.1
      - wandb==0.21.1
      
      # Flash Attention - compatible with PyTorch 2.6.0
      - flash-attn==2.7.4.post1
      
      # OpenRLHF and dependencies
      - openrlhf==0.8.1
      - deepspeed==0.16.8
      - ray==2.43.0
      
      # vLLM without conflicting flash-attn
      - vllm==0.8.3
      # Remove vllm-flash-attn to avoid conflict
      
      # xformers for attention
      - xformers==0.0.29.post2
      
      # Additional dependencies
      - einops==0.8.1
      - safetensors==0.6.2
      - tokenizers==0.21.4
      - huggingface-hub==0.34.4
      - bitsandbytes==0.46.1
      - optimum==1.27.0
      - sentencepiece==0.2.0
      - tiktoken==0.10.0
      - psutil==7.0.0
      - ninja==1.13.0
      - tensorboard==2.20.0
      - fastapi==0.116.1
      - uvicorn==0.35.0